<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The movespy Manual &mdash; movespy 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="movespy 0.1.0 documentation" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="#">movespy 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-movespy-manual">
<h1>The movespy Manual<a class="headerlink" href="#the-movespy-manual" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>MOVES is a software package developed by the US EPA for estimating pollution
from cars. MOVES is a valuable resource for analysts because it is based
upon substantial and rigorous research. Some analysts may even be required
to use MOVES because it is mandatory for certain analysis linked to federal
transportation funding.</p>
<p><tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> aims to make using MOVES easier by making it easy to
write programs to automate MOVES runs and retrieve the results.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently <tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> focuses on project-level on-road analysis. In the future
<tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> may also focus on county-level or off-road analysis.</p>
</div>
<div class="section" id="installing-and-learning-python">
<h3>Installing and learning Python<a class="headerlink" href="#installing-and-learning-python" title="Permalink to this headline">¶</a></h3>
<p><tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> is implemented as a Python package. To use <tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> effectively you should know at least a little about Python. But don&#8217;t worry: Python is easy to learn. And once you know it there&#8217;s a lot you can do with it (not just <tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt>). To download Python go to <a class="reference external" href="http://python.org/">python.org</a>. To learn Python, try one of the many good <a class="reference external" href="http://www.google.com/search?q=python+tutorial">Python tutorials</a> online.</p>
</div>
<div class="section" id="installing-moves">
<h3>Installing MOVES<a class="headerlink" href="#installing-moves" title="Permalink to this headline">¶</a></h3>
<p><tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> works by interacting with MOVES, so you&#8217;ll need to install MOVES on your computer. To download MOVES go to the EPA&#8217;s <a class="reference external" href="http://www.epa.gov/otaq/models/moves/index.htm">MOVES webpage</a>.</p>
<p>When you install moves, make a note of the folder where you put it. You&#8217;ll need that to install <tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt>.</p>
</div>
<div class="section" id="installing-movespy">
<h3>Installing <tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt><a class="headerlink" href="#installing-movespy" title="Permalink to this headline">¶</a></h3>
<p>Download the <a class="reference external" href="https://pypi.python.org/pypi/movespy">installer</a> and run it.</p>
<p>Next, open the <tt class="docutils literal"><span class="pre">movespy_settings.py</span></tt> module in the <tt class="docutils literal"><span class="pre">movespy</span></tt> folder. You
should see something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">moves_dir</span><span class="o">=</span><span class="s">&quot;C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">Public</span><span class="se">\\</span><span class="s">MOVES20120410&quot;</span>
<span class="n">moves_db</span> <span class="o">=</span><span class="s">&quot;movesdb20120410&quot;</span>
</pre></div>
</div>
<p>You might need to edit the two text values inside the quotes. The first one
should be the complete path to your MOVES installation directory (the one
you noted when you installed MOVES). Remember to use double slashes. The
second one should be the name of the MOVES database (which is assumed to be
on the local MySQL server). If you&#8217;re not what the database name is, it&#8217;s
probably the same as the name of the installation folder, with &#8220;moves&#8221; in
lower case, and &#8220;db&#8221; inserted after &#8220;moves&#8221; and before the numbers. Once
you&#8217;ve make your edits, make sure to save the file.</p>
</div>
<div class="section" id="getting-help">
<h3>Getting Help<a class="headerlink" href="#getting-help" title="Permalink to this headline">¶</a></h3>
<p>If you need help with movespy, please email Eric.</p>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-movespy-to-run-moves">
<h3>Using <tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> to run MOVES<a class="headerlink" href="#using-movespy-to-run-moves" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s say we would like to estimate emissions for vehicle traffic on a single link. First some details about the link:</p>
<blockquote>
<div><ul class="simple">
<li>This link has a volume of 400 vehicles per hour, a length of 0.25 miles, and an average speed of 34 mph.</li>
<li>It&#8217;s an urban surface street (not a freeway) and it&#8217;s one-way and has a grade of -1.2 percent in the direction of travel.</li>
<li>The link is in Windsor County, Vermont and we want to do the analysis for 4:00 pm on a weekday in June in 2015.</li>
<li>Just to make things easy, all the vehicles on the link are passenger cars, and they are all five years old.</li>
</ul>
</div></blockquote>
<p>To set up this analysis we first construct a <cite>links</cite> <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt> that holds
just one key-value pair. The key is the ID for the link, which in this case
is <tt class="docutils literal"><span class="pre">1</span></tt>. The
value is another <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt> that has that has strings for keys and our input
data for values, like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">links</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;grade&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span>
             <span class="s">&#39;length&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
             <span class="s">&#39;road_type&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="c">#5 is the ID for an urban non-freeway</span>
             <span class="s">&#39;source_distr&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">21</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span> <span class="c">#21 is the ID for passenger vehicles</span>
             <span class="s">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span>
             <span class="s">&#39;volume&#39;</span><span class="p">:</span> <span class="mi">400</span><span class="p">}}</span>
</pre></div>
</div>
<p>Next we construct an <cite>activity</cite> <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt>, like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">activity</span> <span class="o">=</span>  <span class="p">{</span><span class="s">&#39;age_distr&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">21</span><span class="p">:</span> <span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}},</span>
             <span class="s">&#39;county&#39;</span><span class="p">:</span> <span class="mi">50027</span><span class="p">,</span> <span class="c">#50027 is the ID for Windsor County, Vermont</span>
             <span class="s">&#39;day_type&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="c">#5 is the ID for weekdays</span>
             <span class="s">&#39;hour&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
             <span class="s">&#39;month&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
             <span class="s">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2015</span><span class="p">,</span>
             <span class="s">&#39;links&#39;</span><span class="p">:</span> <span class="n">links</span><span class="p">}</span> <span class="c">#notice that the links dictionary is included here</span>
</pre></div>
</div>
<p>So now we have the <cite>activity</cite> <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt>, which contains the <cite>links</cite> <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt>. Between the two dictionaries, we&#8217;ve included all the input data that we listed at the beginning. There&#8217;s just one more dictionary that we need to make before we can run MOVES, and that&#8217;s the <cite>options</cite> <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;detail&#39;</span><span class="p">:</span> <span class="s">&#39;average&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>This <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt> specifies that we want to use the average speed analysis approach in MOVES (rather than the operating mode distribution approach).</p>
<p>Now we&#8217;re ready. To run MOVES we first import <tt class="xref py py-mod docutils literal"><span class="pre">movespy.moves</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">movespy.moves</span>
</pre></div>
</div>
<p>Then we initialize an instance of the <tt class="xref py py-class docutils literal"><span class="pre">movespy.moves.Moves</span></tt> class, passing the <cite>activity</cite> and <cite>options</cite> dictionaries as parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">moves</span> <span class="o">=</span> <span class="n">movespy</span><span class="o">.</span><span class="n">moves</span><span class="o">.</span><span class="n">Moves</span><span class="p">(</span><span class="n">activity</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we call the <tt class="xref py py-meth docutils literal"><span class="pre">movespy.moves.Moves.run()</span></tt> method on the <tt class="xref py py-class docutils literal"><span class="pre">movespy.moves.Moves</span></tt> instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">emissions_out</span> <span class="o">=</span> <span class="n">moves</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>This kicks-off the MOVES run. When the run is done, the results are returned and assigned to the <cite>emissions_out</cite> variable. Now we can inspect the results. Let&#8217;s say we want to know the total carbon monoxide emissions. We can type:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># 2 is the ID for carbon monoxide</span>
<span class="n">total_CO</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">quantity</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">emissions_out</span> <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">pollutant</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Putting it all together, our entire script for this analysis would be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">links</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;grade&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span>
             <span class="s">&#39;length&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
             <span class="s">&#39;road_type&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
             <span class="s">&#39;source_distr&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">21</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span>
             <span class="s">&#39;speed&#39;</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span>
             <span class="s">&#39;volume&#39;</span><span class="p">:</span> <span class="mi">400</span><span class="p">}}</span>

<span class="n">activity</span> <span class="o">=</span>  <span class="p">{</span><span class="s">&#39;age_distr&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">21</span><span class="p">:</span> <span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}},</span>
             <span class="s">&#39;county&#39;</span><span class="p">:</span> <span class="mi">50027</span><span class="p">,</span>
             <span class="s">&#39;day_type&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
             <span class="s">&#39;hour&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
             <span class="s">&#39;month&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
             <span class="s">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2015</span><span class="p">,</span>
             <span class="s">&#39;links&#39;</span><span class="p">:</span> <span class="n">links</span><span class="p">}</span>

<span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;detail&#39;</span><span class="p">:</span> <span class="s">&#39;average&#39;</span><span class="p">}</span>

<span class="kn">import</span> <span class="nn">movespy.moves</span>
<span class="n">moves</span> <span class="o">=</span> <span class="n">movespy</span><span class="o">.</span><span class="n">moves</span><span class="o">.</span><span class="n">Moves</span><span class="p">(</span><span class="n">activity</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">emissions_out</span><span class="p">,</span> <span class="n">activity_out</span> <span class="o">=</span> <span class="n">moves</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">total_CO</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">quantity</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">emissions_out</span> <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">pollutant</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="using-movespy-to-calculate-vsp-and-operating-mode">
<h3>Using <tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> to calculate VSP and Operating Mode<a class="headerlink" href="#using-movespy-to-calculate-vsp-and-operating-mode" title="Permalink to this headline">¶</a></h3>
<p>We have a vehicle trajectory
dataset produced by a traffic microsimulation. The data set looks like this:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="20%" />
<col width="22%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Time (seconds)</th>
<th class="head">Vehicle ID</th>
<th class="head">Speed (mph)</th>
<th class="head">Grade (percent)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>1</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>1</td>
<td>6</td>
<td>2</td>
</tr>
<tr class="row-even"><td>2</td>
<td>1</td>
<td>1</td>
<td>-3</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>1</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="row-even"><td>3</td>
<td>2</td>
<td>8</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>2</td>
<td>5</td>
<td>1</td>
</tr>
<tr class="row-even"><td>5</td>
<td>2</td>
<td>6</td>
<td>3</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>3</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="row-even"><td>3</td>
<td>3</td>
<td>9</td>
<td>-2</td>
</tr>
<tr class="row-odd"><td>4</td>
<td>3</td>
<td>1</td>
<td>3</td>
</tr>
<tr class="row-even"><td>5</td>
<td>3</td>
<td>3</td>
<td>-4</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>3</td>
<td>9</td>
<td>-2</td>
</tr>
</tbody>
</table>
<p>The data set includes
three vehicles and 12 vehicle seconds. Vehicle 1 has four seconds,
vehicle 2 has three seconds, and vehicle 3 has five seconds. Each of the
three vehicles starts at a different time: seconds 0, 3, and 2 for vehicles
1, 2 and 3 respectively. For each vehicle second, the speed in miles per hour
and grade in percent is given in the table. We will also assume that
all three vehicles have a mass of 2.0 tonnes, and that they are all
passenger vehicles.</p>
<p>We want to use <tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> to calculate the VSP and operating mode for
each vehicle second. Before we can do that, we need find values for
four parameters of the VSP equation: fixed mass factor, alpha, beta and gamma.
Fortunately, MOVES has default values for these parameters for each of the
vehicle types. So we look up passenger vehicles in the sourceusetype table
of the MOVES database, and find that the values of these parameters are
1.5, 0.16, 0.0020, and 0.00049 respectively.</p>
<p>Now we&#8217;re ready to calculate VSP and operating mode. First, we prepare
our inputs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">veh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">speed</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span><span class="mf">6.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">8.</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">6.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">9.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">9.</span><span class="p">]</span>
<span class="n">grade</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="o">-</span><span class="mf">3.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="o">-</span><span class="mf">4.</span><span class="p">,</span><span class="o">-</span><span class="mf">2.</span><span class="p">]</span>
<span class="n">mass</span><span class="p">,</span> <span class="n">mass_factor</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.0020</span><span class="p">,</span> <span class="mf">0.00049</span>
</pre></div>
</div>
<p>Next we import the <tt class="xref py py-mod docutils literal"><span class="pre">movespy.trajectory</span></tt> module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">movespy.trajectory</span>
</pre></div>
</div>
<p>Finally, we run the <tt class="xref py py-func docutils literal"><span class="pre">moves.trajectory.getVSPOpMode()</span></tt> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">vsp</span><span class="p">,</span> <span class="n">opmode</span> <span class="o">=</span> <span class="n">movespy</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">getVSPOpMode</span><span class="p">(</span><span class="n">veh</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">grade</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span>
    <span class="n">mass_factor</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="using-movespy-to-generate-emission-rate-look-up-tables">
<h3>Using <tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> to Generate Emission Rate Look-up Tables<a class="headerlink" href="#using-movespy-to-generate-emission-rate-look-up-tables" title="Permalink to this headline">¶</a></h3>
<p>To generate a look-up table of emissions rates, you will need to provide an activity argument that is similar
to the activity argument for the <tt class="xref py py-class docutils literal"><span class="pre">movespy.moves.Moves</span></tt> initializer, except that it does not include
the &#8216;links&#8217; key/value pair. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">activity</span> <span class="o">=</span>  <span class="p">{</span><span class="s">&#39;age_distr&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">62</span><span class="p">),</span>
                                    <span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}),</span>
             <span class="s">&#39;county&#39;</span><span class="p">:</span> <span class="mi">50027</span><span class="p">,</span>
             <span class="s">&#39;day_type&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
             <span class="s">&#39;hour&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
             <span class="s">&#39;month&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
             <span class="s">&#39;year&#39;</span><span class="p">:</span> <span class="mi">2015</span><span class="p">}</span>
</pre></div>
</div>
<p>This dictionary specifies that we want a look up table for a fleet composed entirely of vehicles that
are five years old; in Windsor County, Vermont; on weekday; during the 4:00 pm hour; in June; and
in the year 2015. To generate the look up table we first import the <tt class="xref py py-mod docutils literal"><span class="pre">movespy.ratetable</span></tt> module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">movespy.ratetable</span>
</pre></div>
</div>
<p>Then we run the <tt class="xref py py-func docutils literal"><span class="pre">movespy.ratetable.getRateTable()</span></tt> function, with our activity dictionary as the argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">table</span> <span class="o">=</span> <span class="n">movespy</span><span class="o">.</span><span class="n">ratetable</span><span class="o">.</span><span class="n">getRateTable</span><span class="p">(</span><span class="n">activity</span><span class="p">)</span>
</pre></div>
</div>
<p>The result is a nested dict with keys for pollutant, source type, and operating mode. The
values are emissions rates in either grams or kJ per vehicle-hour. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">21</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
<span class="go">123.456</span>
</pre></div>
</div>
<p>If you want to create a flat file look up table, you could do:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;pollutant&#39;</span><span class="p">,</span> <span class="s">&#39;source_type&#39;</span><span class="p">,</span> <span class="s">&#39;op_mode&#39;</span><span class="p">,</span> <span class="s">&#39;rate&#39;</span><span class="p">]</span>

<span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">pollutant</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">source_type</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="n">pollutant</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">op_mode</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="n">pollutant</span><span class="p">][</span><span class="n">source_type</span><span class="p">]:</span>

            <span class="n">rate</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">pollutant</span><span class="p">][</span><span class="n">source_type</span><span class="p">][</span><span class="n">op_mode</span><span class="p">]</span>

            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">pollutant</span> <span class="o">=</span> <span class="n">pollutant</span><span class="p">,</span>
                             <span class="n">source_type</span> <span class="o">=</span> <span class="n">source_type</span><span class="p">,</span>
                             <span class="n">op_mode</span> <span class="o">=</span> <span class="n">op_mode</span><span class="p">,</span>
                             <span class="n">rate</span> <span class="o">=</span> <span class="n">rate</span><span class="p">))</span>


<span class="kn">import</span> <span class="nn">csv</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;table.csv&#39;</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>

    <span class="n">d</span><span class="o">.</span><span class="n">writeheader</span><span class="p">()</span>

    <span class="n">d</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="moves-class-initializer-parameters">
<h2>Moves Class Initializer Parameters<a class="headerlink" href="#moves-class-initializer-parameters" title="Permalink to this headline">¶</a></h2>
<p>Before you can run MOVES you need to construct the <cite>&lt;activity&gt;</cite> and <cite>&lt;options&gt;</cite>
parameters
for the <tt class="xref py py-class docutils literal"><span class="pre">Moves</span></tt> class initializer. Study this section to learn the structure for each.</p>
<dl class="glossary docutils">
<dt id="term-activity">&lt;activity&gt;</dt>
<dd><p class="first">A mapping:</p>
<div class="highlight-python"><pre>{'county':&lt;county_id&gt;,
 'year':&lt;year&gt;,
 'month':&lt;month&gt;,
 'hour':&lt;hour&gt;,
 'day_type':&lt;day_type_id&gt;,
 'age_distr':&lt;age_distr&gt;
 'links':&lt;links&gt;}</pre>
</div>
<p class="last">This is the root level of the <cite>&lt;activity&gt;</cite> parameter.</p>
</dd>
<dt id="term-age">&lt;age&gt;</dt>
<dd>An integer between 0 and 30. Zero means new, and 30
means 30 years old.</dd>
<dt id="term-age-distr">&lt;age_distr&gt;</dt>
<dd><p class="first">A mapping:</p>
<div class="last highlight-python"><pre>{&lt;source_type_id&gt;:&lt;source_type_age_distr&gt;,
 ...,
&lt;source_type_id&gt;:&lt;source_type_age_distr&gt;}</pre>
</div>
</dd>
<dt id="term-breakdown-selection">&lt;breakdown_selection&gt;</dt>
<dd>One of <cite>&#8216;model_year&#8217;</cite>, <cite>&#8216;fuel&#8217;</cite>, <cite>&#8216;process&#8217;</cite>, or <cite>&#8216;source&#8217;</cite>.</dd>
<dt id="term-breakdown-selections">&lt;breakdown_selections&gt;</dt>
<dd><p class="first">An iterable:</p>
<div class="highlight-python"><pre>[&lt;breakdown_selection&gt;, ...]</pre>
</div>
<p class="last">Specifies by which fields the output should be disaggregated.</p>
</dd>
<dt id="term-county-id">&lt;county_id&gt;</dt>
<dd>An integer identifying the county. Find this in the county table of the MOVES database.</dd>
<dt id="term-day-type-id">&lt;day_type_id&gt;</dt>
<dd>An integer for the day type. 5 for weekday, and 2 for weekend.</dd>
<dt id="term-detail">&lt;detail&gt;</dt>
<dd>One of <tt class="docutils literal"><span class="pre">'average'</span></tt>, <tt class="docutils literal"><span class="pre">'opmode'</span></tt>, or <tt class="docutils literal"><span class="pre">'driveschedule'</span></tt>.</dd>
<dt id="term-driveschedule">&lt;driveschedule&gt;</dt>
<dd>A sequence of tuples. Each tuple contains two items: Speed in miles per hour (a float),
and grade in percent (a float). Represents a vehicle trajectory. Must be sorted by time, and
observations must be one second apart.</dd>
<dt id="term-hour">&lt;hour&gt;</dt>
<dd>An integer for the hour (0 = midnight).</dd>
<dt id="term-length">&lt;length&gt;</dt>
<dd><p class="first">A real number giving the length of the link in miles. This value (in miles) should always
be less than &lt;speed&gt; (in mph).</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the value of <cite>&lt;length&gt;</cite> is greater than the value of <cite>&lt;speed&gt;</cite> the results will
not be correct. A work-around is to adjust the values of <cite>&lt;length&gt;</cite> and <cite>&lt;volume&gt;</cite>
so that their product remains constant and <cite>&lt;length&gt;</cite> is less than <cite>&lt;speed&gt;</cite>.</p>
</div>
</dd>
<dt id="term-link">&lt;link&gt;</dt>
<dd><p class="first">A mapping:</p>
<div class="highlight-python"><pre>{'road_type':&lt;road_type_id&gt;,
 'length':&lt;length&gt;,
 'volume':&lt;volume&gt;,
 'speed':&lt;speed&gt;,
 'grade':&lt;grade&gt;,
 'source_distr':&lt;source_distr&gt;,
 'opmode_distr':&lt;opmode_distr&gt;,
 'driveschedule':&lt;driveschedule&gt;}</pre>
</div>
<p class="last">The <tt class="docutils literal"><span class="pre">'opmode_distr'</span></tt> key and its value are only required if the value for
the <tt class="docutils literal"><span class="pre">'detail'</span></tt> key in the <cite>&lt;options&gt;</cite> dictionary is <tt class="docutils literal"><span class="pre">'opmode'</span></tt>.
The <tt class="docutils literal"><span class="pre">'driveschedule'</span></tt> key and its value are only required if the value for
the <tt class="docutils literal"><span class="pre">'detail'</span></tt> key in the <cite>&lt;options&gt;</cite> dictionary is <tt class="docutils literal"><span class="pre">'driveschedule'</span></tt>.</p>
</dd>
<dt id="term-link-id">&lt;link_id&gt;</dt>
<dd>An arbitrary positive integer identifying the link</dd>
<dt id="term-links">&lt;links&gt;</dt>
<dd><p class="first">A mapping:</p>
<div class="last highlight-python"><pre>{&lt;link_id&gt;:&lt;link&gt;,
 ...,
 &lt;link_id&gt;:&lt;link&gt;}</pre>
</div>
</dd>
<dt id="term-month">&lt;month&gt;</dt>
<dd>An integer for the month (1 = January).</dd>
<dt id="term-opmode-distr">&lt;opmode_distr&gt;</dt>
<dd><p class="first">A mapping:</p>
<div class="last highlight-python"><pre>{&lt;source_type_id&gt;:&lt;source_type_opmode_distr&gt;,
 ...,
 &lt;source_type_id&gt;:&lt;source_type_opmode_distr&gt;}</pre>
</div>
</dd>
<dt id="term-opmode-id">&lt;opmode_id&gt;</dt>
<dd><p class="first">One of the following integers: 0,1,11,12,13,14,15,16,21,22,23,24,25,27,28,29,30,
33,35,37,38,39,40,501.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Values of <cite>&lt;opmode_id&gt;</cite> must be calculated as by the <cite>getOpMode</cite> function in the
movespy.trajectory module. Note in particular that when speed == 0.0 the opmode is
always 501, regardless of the pollutant or process you may be interested in.</p>
</div>
</dd>
<dt id="term-options">&lt;options&gt;</dt>
<dd><p class="first">A mapping:</p>
<div class="highlight-python"><pre>{'detail':&lt;detail&gt;,
 'pollutants':&lt;pollutants&gt;,
 'breakdown':&lt;breakdown_selections&gt;}</pre>
</div>
<p class="last">This is the root level of the <cite>&lt;options&gt;</cite> parameter. The <cite>&#8216;pollutants&#8217;</cite> key
is optional. If it is not included then all pollutants
will be calculated. The <cite>&#8216;breakdown&#8217;</cite> key
is optional. If it is not included the output will be disaggregated by link and pollutant
only.</p>
</dd>
<dt id="term-pollutants">&lt;pollutants&gt;</dt>
<dd><p class="first">A sequence of integers identifying pollutants to be calculated. Find these in the pollutant
table in the MOVES database. If the list is empty, no pollutants will be calculated.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The calculation of many pollutants depends on
the calculation of other pollutants. To get correct results, all dependencies must
be included in this sequence. Dependencies are not documented yet (at least not here).
To be safe,
calculate all pollutants by not including the <tt class="docutils literal"><span class="pre">'pollutants'</span></tt> key in the <cite>&lt;options&gt;</cite>
dictionary.</p>
</div>
</dd>
<dt id="term-proportion">&lt;proportion&gt;</dt>
<dd>A real number between 0 and 1.</dd>
<dt id="term-road-type">&lt;road_type&gt;</dt>
<dd>An integer identifying the road type. Find this in the table roadtype in the MOVES database.
Note that <tt class="xref py py-mod docutils literal"><span class="pre">movespy</span></tt> currently support only on-road analysis.</dd>
<dt id="term-source-distr">&lt;source_distr&gt;</dt>
<dd><p class="first">A mapping:</p>
<div class="highlight-python"><pre>{&lt;source_type_id&gt;:&lt;proportion&gt;,
 ...,
 &lt;source_type_id&gt;:&lt;proportion&gt;}</pre>
</div>
<p class="last">For keys not given the proportion is assumed to be zero. Proportions should sum to one.</p>
</dd>
<dt id="term-source-type-age-distr">&lt;source_type_age_distr&gt;</dt>
<dd><p class="first">A mapping:</p>
<div class="highlight-python"><pre>{&lt;age&gt;:&lt;proportion&gt;,
 ...,
 &lt;age&gt;:&lt;proportion&gt;}</pre>
</div>
<p class="last">For keys not included, the proportion is assumed to be zero. Proportion
values should sum to one.</p>
</dd>
<dt id="term-source-type-id">&lt;source_type_id&gt;</dt>
<dd>An integer identifying the source type. Find this in the sourceusetype table of the
MOVES database.</dd>
<dt id="term-source-type-opmode-distr">&lt;source_type_opmode_distr&gt;</dt>
<dd><p class="first">A mapping:</p>
<div class="highlight-python"><pre>{&lt;opmode_id&gt;:&lt;proportion&gt;,
 ...,
 &lt;opmode_id&gt;:&lt;proportion&gt;}</pre>
</div>
<p class="last">For keys not given the proportion is assumed to be zero. Proportions should sum to one.</p>
</dd>
<dt id="term-speed">&lt;speed&gt;</dt>
<dd>A real number giving the average speed in miles per hour</dd>
<dt id="term-volume">&lt;volume&gt;</dt>
<dd>A real number giving the volume in vehicles per hour.</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The movespy Manual</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#installing-and-learning-python">Installing and learning Python</a></li>
<li><a class="reference internal" href="#installing-moves">Installing MOVES</a></li>
<li><a class="reference internal" href="#installing-movespy">Installing <tt class="docutils literal"><span class="pre">movespy</span></tt></a></li>
<li><a class="reference internal" href="#getting-help">Getting Help</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#using-movespy-to-run-moves">Using <tt class="docutils literal"><span class="pre">movespy</span></tt> to run MOVES</a></li>
<li><a class="reference internal" href="#using-movespy-to-calculate-vsp-and-operating-mode">Using <tt class="docutils literal"><span class="pre">movespy</span></tt> to calculate VSP and Operating Mode</a></li>
<li><a class="reference internal" href="#using-movespy-to-generate-emission-rate-look-up-tables">Using <tt class="docutils literal"><span class="pre">movespy</span></tt> to Generate Emission Rate Look-up Tables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#moves-class-initializer-parameters">Moves Class Initializer Parameters</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="#">movespy 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Eric S. Talbot.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>